<!doctype html>
<html lang="en">
  <head>
    <title>BlackBear | Journal Post</title>
    <link rel="icon" type="image/png" href="images/icon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="css/vendor/icomoon/style.css">
    <link rel="stylesheet" href="css/vendor/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">

    <style>
      /* Fondo de video fijo */
      .video-bg-global { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: #000; }
      .video-bg-global video { width: 100%; height: 100%; object-fit: cover; opacity: 0.4; }
      body, .unslate_co--site-wrap, .unslate_co--site-inner, .unslate_co--section, .cover-v1 { background-color: transparent !important; }
      
      /* Ajuste de Altura de Portada (Reducida a 65vh) */
      #post-header { height: 65vh !important; background-size: cover; background-position: center; position: relative; }
      #post-header.overlay:before { background: rgba(0,0,0,0.5); content: ""; position: absolute; top:0; left:0; right:0; bottom:0; }
      
      /* Visibilidad del Texto */
      .post-content { 
        font-size: 1.15rem; 
        line-height: 1.9; 
        color: #ffffff !important; 
        text-shadow: 0 2px 15px rgba(0,0,0,1); /* Sombra fuerte para lectura clara */
      }
      .post-content img { width: 100%; border-radius: 8px; margin: 30px 0; }

      /* Animación Scroll Mouse */
      .scroll-container-blog { text-align: center; margin-top: 20px; width: 100%; }
      .scroll-container-blog .mouse { border: 2px solid #fff; border-radius: 20px; height: 35px; width: 22px; display: block; margin: 0 auto 8px auto; position: relative; }
      .scroll-container-blog .scroll { background: #fff; border-radius: 10px; height: 5px; width: 2px; position: absolute; top: 6px; left: 50%; margin-left: -1px; animation: scroll 1.5s infinite; }
      .scroll-container-blog .mouse-label { color: #fff; text-transform: uppercase; font-size: 9px; letter-spacing: 2px; font-weight: 700; }
      @keyframes scroll { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(12px); opacity: 0; } }

      /* Navegación y Spacing */
      .navigation-post { border-top: 1px solid rgba(255,255,255,0.1); padding-top: 40px; margin-top: 40px; }
      .navigation-post p { color: #fff; font-weight: 700; font-size: 1.1rem; }
      
      /* Footer Gris (Sin espacio negro infinito abajo) */
      .unslate_co--footer {
        background-color: #191919 !important;
        position: relative !important;
        padding: 50px 0 !important; /* Relleno controlado */
        margin-top: 50px !important;
      }
    </style>
  </head>
  <body>

    <div class="video-bg-global">
      <video autoplay loop muted playsinline><source src="video/bg.mp4" type="video/mp4"></video>
    </div>

    <div class="unslate_co--site-wrap">
      <div class="unslate_co--site-inner">

        <nav class="unslate_co--site-nav site-nav-target">
          <div class="container">
            <div class="row align-items-center justify-content-between">
              <div class="col-md-5 text-right">
                <ul class="site-nav-ul js-clone-nav text-left d-none d-lg-inline-block">
                  <li><a href="index.html#home-section" class="nav-link">Home</a></li>
                  <li><a href="index.html#portfolio-section" class="nav-link">Portfolio</a></li>
                </ul>
              </div>
              <div class="site-logo pos-absolute">
                <a href="index.html" class="unslate_co--site-logo" style="background: white; padding: 8px 12px; border-radius: 5px;">
                  <img src="images/logo.png" alt="Logo" style="height: 35px;">
                </a>
              </div>
              <div class="col-md-5 text-right text-lg-left">
                <ul class="site-nav-ul js-clone-nav text-left d-none d-lg-inline-block">
                  <li><a href="index.html#journal-section" class="nav-link active">Journal</a></li>
                  <li><a href="index.html#contact-section" class="nav-link">Contact</a></li>
                </ul>
              </div>
            </div>
          </div>
        </nav>

        <div class="cover-v1 overlay" id="post-header">
          <div class="container">
            <div class="row align-items-center justify-content-center" style="height: 65vh;">
              <div class="col-md-10 text-center" style="z-index: 2;">
                <h1 class="heading" id="post-title" style="font-size: 3.5rem; font-weight: 900;">Cargando...</h1>
                <div id="post-meta" style="color: rgba(255,255,255,0.7); margin-bottom: 20px;"></div>
                <div class="scroll-container-blog">
                  <span class="mouse"><span class="scroll"></span></span>
                  <span class="mouse-label">Scroll</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="unslate_co--section">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-md-8 post-content" id="post-content"></div>
            </div>

            <div class="row navigation-post">
              <div class="col-6"><a href="#" id="prev-link" class="text-white"><span style="opacity:0.5; font-size:10px;">&larr; PREVIOUS</span><p id="prev-title">...</p></a></div>
              <div class="col-6 text-right"><a href="#" id="next-link" class="text-white"><span style="opacity:0.5; font-size:10px;">NEXT &rarr;</span><p id="next-title">...</p></a></div>
            </div>

            <div class="row justify-content-center mt-5">
              <div class="col-md-8">
                <h3 class="text-center mb-4" id="comment-count">0 Comments</h3>
                <ul class="comment-list" id="dynamic-comments" style="padding:0; list-style:none;"></ul>
                <form id="commentForm" class="mt-5 p-4" style="background: rgba(255,255,255,0.05); border-radius:10px;">
                  <div class="form-group"><label>Name</label><input type="text" class="form-control" id="name" required></div>
                  <div class="form-group"><label>Message</label><textarea id="message" class="form-control" rows="4" required></textarea></div>
                  <div class="text-center"><input type="submit" value="Post Comment" class="btn btn-outline-pill btn-custom-light" id="submitBtn"></div>
                </form>
              </div>
            </div>
          </div>
        </div>

        <footer class="unslate_co--footer">
          <div class="container text-center">
            <div class="mb-3"><img src="images/logo.png" alt="Logo" style="height: 30px; background: white; padding: 5px; border-radius: 3px;"></div>
            <p style="opacity:0.5; font-size:12px;">Copyright &copy; 2026 BlackBear. All rights reserved.</p>
          </div>
        </footer>

      </div>
    </div>

    <script src="js/scripts-dist.js"></script>
    <script src="js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script>
      const URL_POSTS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSBApKJcrHq_sBa2EA4YDyj4GeFrGJ-uH6HzYjGaMbw_tQAIg1Ll6h_w42HbyC2Wuz5uVIDAG0nvbo0/pub?gid=0&single=true&output=csv";
      const URL_COMS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSBApKJcrHq_sBa2EA4YDyj4GeFrGJ-uH6HzYjGaMbw_tQAIg1Ll6h_w42HbyC2Wuz5uVIDAG0nvbo0/pub?gid=328009394&single=true&output=csv";
      const URL_SCRIPT = "https://script.google.com/macros/s/AKfycby1w3WCAhLKvRlppqqnwf4TLyb8yCVcz6KXxnsO-gwsz_wJqb1Dj7a4vbQISltivviqzA/exec";

      const postID = new URLSearchParams(window.location.search).get('id') || 1;

      Papa.parse(URL_POSTS, { download: true, header: true, complete: function(res) {
        const posts = res.data.filter(p => p.ID);
        const post = posts.find(p => p.ID == postID) || posts[0];
        document.getElementById('post-title').innerText = post.Titulo;
        document.getElementById('post-meta').innerText = `By ${post.Autor} • ${post.Fecha}`;
        document.getElementById('post-content').innerHTML = post.Contenido;
        document.getElementById('post-header').style.backgroundImage = `url('${post.ImagenPortada}')`;
        let idx = posts.findIndex(p => p.ID == postID);
        let prev = posts[(idx - 1 + posts.length) % posts.length], next = posts[(idx + 1) % posts.length];
        document.getElementById('prev-link').href = `blog-single.html?id=${prev.ID}`;
        document.getElementById('prev-title').innerText = prev.Titulo;
        document.getElementById('next-link').href = `blog-single.html?id=${next.ID}`;
        document.getElementById('next-title').innerText = next.Titulo;
      }});

      Papa.parse(URL_COMS, { download: true, header: true, complete: function(res) {
        const comments = res.data.filter(c => c.PostID == postID);
        document.getElementById('comment-count').innerText = `${comments.length} Comments`;
        document.getElementById('dynamic-comments').innerHTML = comments.reverse().map(c => `
          <li style="border-bottom:1px solid rgba(255,255,255,0.1); padding:20px 0;">
            <h4 style="color:#fff; margin:0;">${c.Nombre}</h4>
            <small style="opacity:0.5;">${c.Fecha}</small>
            <p style="margin-top:10px;">${c.Mensaje}</p>
          </li>`).join('');
      }});

      document.getElementById('commentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const btn = document.getElementById('submitBtn'); btn.value = "Sending..."; btn.disabled = true;
        const fd = new URLSearchParams(); fd.append('postID', postID); fd.append('name', document.getElementById('name').value); fd.append('message', document.getElementById('message').value);
        fetch(URL_SCRIPT, { method: 'POST', mode: 'no-cors', body: fd }).then(() => { alert("Success!"); location.reload(); });
      });
    </script>
  </body>
</html>
